


services:

  db:
    image: postgres:16-alpine # è»½é‡ãªPostgreSQLã‚¤ãƒ¡ãƒ¼ã‚¸
    container_name: postgres_db
    restart: always
    environment:
      # âš ï¸ å¿…é ˆï¼šã‚¢ã‚¯ã‚»ã‚¹ã«å¿…è¦ãªç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
      POSTGRES_USER: postgres # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¦ãƒ¼ã‚¶ãƒ¼å
      POSTGRES_PASSWORD: postgres # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
      POSTGRES_DB: appdb # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åï¼ˆæ¥ç¶šæ™‚ã«ä½¿ç”¨ï¼‰
    volumes:
      # ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–è¨­å®š: ãƒ›ã‚¹ãƒˆå´ã® 'pgdata' ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
      - pgdata:/var/lib/postgresql/data
    ports:
      # å¤–éƒ¨ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å ´åˆã«ãƒãƒ¼ãƒˆã‚’å…¬é–‹ (Go/Reactã‹ã‚‰ã¯ã‚µãƒ¼ãƒ“ã‚¹åã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ä¸è¦ãªå ´åˆã‚‚ã‚ã‚‹)
      - "5432:5432"

  go:
    build:
      context: ./go
      dockerfile: Dockerfile
    container_name: go-api
    environment:
      # ğŸ’¡ Goã‚³ãƒ¼ãƒ‰ãŒDBæ¥ç¶šã«ä½¿ç”¨ã™ã‚‹æƒ…å ±
      DB_HOST: db        # DBã‚µãƒ¼ãƒ“ã‚¹ã®ã‚³ãƒ³ãƒ†ãƒŠå
      DB_PORT: 5432
      DB_USER: postgres
      DB_PASSWORD: password
      DB_NAME: appdb
    ports:
      - "8080:8080"
    volumes:
      - ./go:/app
    tty: true
  react:
    build:
      context: ./react
      dockerfile: Dockerfile
    ports:
      - "80:80"
    volumes:
      - ./react:/app
    tty: true


volumes:
  pgdata:
    # DBã®å†…å®¹ãŒã‚³ãƒ³ãƒ†ãƒŠã«ä¾å­˜ã—ãªã„ã‚ˆã†ã«ãƒ­ãƒ¼ã‚«ãƒ«PCã«ä½œæˆã™ã‚‹
    driver: local
